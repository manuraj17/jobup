version: '2'
services:
  db_data: 
    image: postgres
    entrypoint: /bin/bash
    environment:
      TERM: xterm-256-color
  db:
    image: postgres
    volumes_from:
      - db_data
    environment:
      POSTGRES_PASSWORD: mypass
      POSGRES_USER: postgres
      ports: 
        - "5432:5432"
      expose:
        - "5432"
  web:
    build: .
    command: bash -c "rails s -p 3000 -b '0.0.0.0'"
    environment:
      DATABASE_URL: postgres://postgres:mypass@db5432
      PASSENGER_APP_ENV: development
    volumes: 
      - .:/home/app/myapp
    ports:
      - "3000:3000"
      - "23:22"
    depends_on:
      - db
